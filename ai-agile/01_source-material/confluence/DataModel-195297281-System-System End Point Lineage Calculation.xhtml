---
source: https://maoperatingsystem.atlassian.net/spaces/DataModel/pages/195297281/System-System+End+Point+Lineage+Calculation
confluence_id: 195297281
space: DataModel
version: 33
retrieved: 2026-01-23T12:36:39.585104
format: xhtml
content_hash: 04e881c5d2c1e04602580d49e8834a4d
macro_structured_macro: 2
macro_image: 0
macro_link: 0
---
<ac:layout>
<ac:layout-section ac:type="fixed-width" ac:breakout-mode="default">
<ac:layout-cell>
<h1>About this Document</h1>
<p>This quick one-pager provides a high-level approach for calculating &ldquo;lineage complete&rdquo; based on a minimal amount of information about the elements within a lineage map.  This proposes a minimum set of definitions that represent the start and end points of a lineage tree, along with an algorithm for traversing the tree &ldquo;backwards&rdquo; to calculate the depth from desired end points and then &ldquo;forwards&rdquo; to calculate a current understanding of lineage completeness.  </p>
<p>
<em>Note: This document does not establish a definition of &ldquo;Authorised Source&rdquo; which is specific to individual organisations' data governance policy</em>
</p>
<h1>Table of Contents</h1>
<ac:structured-macro ac:name="toc" ac:schema-version="1" data-layout="default" ac:local-id="d85b15d4-7686-456d-bbef-00efe06f346b" ac:macro-id="9aae7379-cdc9-4bef-985b-1e1d7dfd4beb"><ac:parameter ac:name="style">none</ac:parameter></ac:structured-macro>
<h1>Physical End Point Lineage Calculation</h1>
<h2>Assumptions</h2>
<ul>
<li>
<p>All the following refers to attributes and lineage typically provided by tech-based lineage work.</p>
</li>
<li>
<p>This document provides a method for calculating &ldquo;Lineage complete&rdquo; using this data.  Any additional work to provide a logical view above or to prioritize critical versus non-critical paths can be applied on top of this in the future.</p>
</li>
<li>
<p>This document does not attempt to account for &ldquo;context-based lineage&rdquo; and provides a worked example for a single lineage tree.</p>
</li>
<li>
<p>In addition to the definitions contained in this document, we can logically determine if we believe the lineage is complete at a node and is considered an &ldquo;authorized source&rdquo;.</p>
</li>
<li>
<p>Different policies may define different designations of data elements and criticalities. For the purposes of documenting an algorithm, here we are using;</p>
<ul>
<li>
<p>End Point Value (EPV) - an attribute in the lineage that represents the &quot;end&rdquo; of the combined physical lineage as the desired business outcome</p>
</li>
<li>
<p>Authoritative Source (AS) - an attribute in the lineage that represents the &quot;start&rdquo; of a physical lineage path and has been confirmed as an official source.  No further decomposition is needed.</p>
</li>
</ul>
</li>
</ul>
<h2>Calculations</h2>
<p>For each node, we need to determine</p>
<ol start="1">
<li>
<p>Status - this is the classification of the node  - ie, EPV vs AS vs Complete (COM) vs Unknown (XX)</p>
</li>
<li>
<p>Depth &ldquo;back&rdquo; from EPV - This is used to sequence the rollup of complete.  By definition, EPVs have backdepth=0.  Backward Depth is the minimum depth of all downstream nodes, plus 1. <em>
<u>Note that this value needs to be calculated per endpoint, as different endpoints will have different paths to this point.</u>
</em>
</p>
</li>
<li>
<p>Depth &ldquo;forward&rdquo; from AS - By definition, nodes identified as an Authoritative source have a fordepth=0.  Forward Depth is the maximum depth of hops to get to this point from all authoritative data sources, plus 1. <em>
<u>Note that this value can only be calculated as authoritative sources are identified. </u>
</em> </p>
</li>
<li>
<p>Score - this is the current &quot;completeness&rdquo; of a node within the tree based on the average completeness of its upstream nodes.  (left to right)</p>
<ol start="1">
<li>
<p>By definition, nodes designated as AS are complete - ie, score = 100% (1.0)</p>
</li>
<li>
<p>By definition, nodes that are not AS and don't have lineage are incomplete, ie, score = 0%</p>
</li>
<li>
<p>By definition, nodes that have lineage where some branches are complete are partial based on average scores of the branches - ie, 0%&lt;score&lt;100%</p>
</li>
<li>
<p>By definition, nodes that have a score of 100% and not AR are status=COM</p>
</li>
</ol>
</li>
</ol>
<p />
<h2>Algorithm</h2>
<p>Note: this is a &ldquo;logical&rdquo; description of the required algorithms - there may be more computationally practical approaches to achieving the below.</p>
</ac:layout-cell>
</ac:layout-section>
<ac:layout-section ac:type="two_equal" ac:breakout-mode="default">
<ac:layout-cell>
<h3>Step #1 - Work &ldquo;backwards&rdquo; away from the EPVs to calculate the depth of each node</h3>
<ul>
<li>
<p>Start with the population of nodes where status = EPV.  Set depth=0</p>
</li>
<li>
<p>Identify upstream nodes, set depth = 1, and add them to the list.</p>
</li>
<li>
<p>For each node in the list,</p>
<ul>
<li>
<p>calculate the minimum depth of upstream nodes.  Set depth to minimum+1</p>
</li>
</ul>
</li>
</ul>
<h3>Step #2 - Work &ldquo;Forwards&rdquo; through the path towards the EPVs to calculate the score for each node</h3>
<ul>
<li>
<p>Identify max depth.</p>
</li>
<li>
<p>Find a list of nodes with this depth.</p>
<ul>
<li>
<p>For each node, If status = AS, set score = 100% Otherwise, calculate the score as the average score of upstream connections.</p>
</li>
</ul>
</li>
<li>
<p>Move to the next level and repeat.</p>
</li>
</ul>
</ac:layout-cell>
<ac:layout-cell>
<h2>Example Chart</h2>
<ac:structured-macro ac:name="drawio" ac:schema-version="1" data-layout="default" ac:local-id="d0c93234-e724-4ac6-9819-6c734fae4ca3" ac:macro-id="670481d4-b392-4a7d-b3bd-20e29cfee9ad"><ac:parameter ac:name="mVer">2</ac:parameter><ac:parameter ac:name="zoom">1</ac:parameter><ac:parameter ac:name="simple">1</ac:parameter><ac:parameter ac:name="inComment">0</ac:parameter><ac:parameter ac:name="custContentId">196083740</ac:parameter><ac:parameter ac:name="pageId">195297281</ac:parameter><ac:parameter ac:name="lbox">1</ac:parameter><ac:parameter ac:name="diagramDisplayName">Untitled Diagram-1755027778568.drawio</ac:parameter><ac:parameter ac:name="contentVer">1</ac:parameter><ac:parameter ac:name="revision">1</ac:parameter><ac:parameter ac:name="baseUrl">https://maoperatingsystem.atlassian.net/wiki</ac:parameter><ac:parameter ac:name="diagramName">Untitled Diagram-1755027778568.drawio</ac:parameter><ac:parameter ac:name="pCenter">0</ac:parameter><ac:parameter ac:name="width">743</ac:parameter><ac:parameter ac:name="links">auto</ac:parameter><ac:parameter ac:name="tbstyle">top</ac:parameter><ac:parameter ac:name="height">1007</ac:parameter><ac:parameter ac:name="aspect" /></ac:structured-macro>
</ac:layout-cell>
</ac:layout-section>
<ac:layout-section ac:type="fixed-width" ac:breakout-mode="default">
<ac:layout-cell>
<p />
</ac:layout-cell>
</ac:layout-section>
</ac:layout>